<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ejemplo de Controladores y Scopes</title>
    <script src="node_modules/angular/angular.js"></script>
</head>
<body ng-app="test">
    <!-- EJEMPLO CONTROLADOR BÁSICO -->
    <!-- Asociar ctrl a view -->
    <div ng-controller="miPrimerControlador">
        <!-- Mensaje -->
        <p>{{ mensaje }}</p>
        <!-- Los métodos ng-loQueSea sustituyen a su omónimos en html. p.ej:
            ng-click == onClick -->
        <button ng-click="saludar()">Saludar</button>
        <p>{{ otroMensaje }}</p><!-- No se puede acceder a otroMensaje porque no está asignado al $scope-->
    </div>


    <!-- EJEMPLO EVENTOS -->
    <div ng-controller="controladorPadre">
        <p>Padre</p>
        <!-- Botón para enviar evento a Ctrl Hijo -->
        <button ng-click="notificarHijo()">Notificar Hijo</button>
        <div ng-controller="controladorHijo">
            <p>Hijo</p>
            <!-- Botón para enviar evento al Ctrl Padre -->
            <button ng-click="notificarPadre()">Notificar Padre</button>
        </div>
    </div>



    <!-- JS -->
    <script>
        // Crear un módulo nuevo llamado "test"
        angular.module("test", []);

        /*
        EJEMPLO BÁSICO DE CTRL
        */
        angular
            .module("test")
            .controller("miPrimerControlador", function($scope){
                $scope.mensaje = "Soy un mensaje en un controlador"; // "mensaje" es accesible en el view
                $scope.saludar = function(){ // función "saludar" accesible en el view
                    alert("Saludo _(_ _)_ ");
                }

                var otroMensaje = "Otro Mensaje"; // Ésto NO es accesible desde $scope y por tanto en el view
            });


        /*
        EJEMPLO DE EVENTOS
        */
        angular
            .module("test")
            .controller("controladorPadre", function($scope) {
                $scope.notificarHijo = function () {
                    $scope.$broadcast("EventoDesdePadre", "Soy evento enviado con $broadcast dese padre");
                }

                $scope.$on("EventoDesdeHijo", function(evt, msj) {
                    alert("CtrlPadre ha recibido el sighiente mensaje:\n" + msj);
                })
            })

        angular
            .module("test")
            .controller("controladorHijo", function($scope) {
                $scope.notificarPadre = function () {
                    $scope.$emit("EventoDesdeHijo", "Soy evento enviado con $emit desde hijo")
                }

                $scope.$on("EventoDesdePadre", function(evt, msj) {
                    alert("CtrlHijo ha recibido el sighiente mensaje:\n" + msj)
                })
                
            })
    </script>

</body>
</html>